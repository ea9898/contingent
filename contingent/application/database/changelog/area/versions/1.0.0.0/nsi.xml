<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.6.xsd">

    <!-- SPECIALIZATION -->
    <changeSet id="CONTINGENT2-NSI-1" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="SPECIALIZATION"/>
            </not>
        </preConditions>
        <comment>Создание таблицы SPECIALIZATION</comment>
        <createTable tableName="SPECIALIZATION">
            <column name="ID" type="BIGINT">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="TITLE" type="VARCHAR2(100)">
                <constraints nullable="false" />
            </column>
            <column name="CODE" type="NUMBER(3)" />
            <column name="ARCHIVED" type="NUMBER(1)" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="SPECIALIZATION"/>
        </rollback>
    </changeSet>
    <!-- !!!! SPECIALIZATION !!!! -->

    <!-- POSITION_CODE -->
    <changeSet id="CONTINGENT2-NSI-14-1" author="ddryuchin">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="POSITION_CODE" />
            </not>
        </preConditions>
        <createTable tableName="POSITION_CODE">
            <column name="GLOBAL_ID" type="BIGINT">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="NOM_TYPE" type="VARCHAR2(10)">
                <constraints nullable="false" />
            </column>
            <column name="SERIAL_NUM" type="BIGINT">
                <constraints nullable="false" />
            </column>
            <column name="CODE" type="VARCHAR2(100)">
                <constraints nullable="false" />
            </column>
            <column name="CONSTANT_TITLE" type="VARCHAR2(250)">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="POSITION_CODE" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-14-2" author="ddryuchin">
        <preConditions onFail="MARK_RAN">
            <columnExists columnName="CODE" tableName="POSITION_CODE" />
        </preConditions>
        <addUniqueConstraint columnNames="CODE"
                             constraintName="UNIQ_CODE_PC"
                             disabled="true"
                             tableName="POSITION_CODE"/>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-14-3" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IXFK_POSITION_CODE_CODE01"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки SPECIALIZATION_ID таблицы POSITION_NOM</comment>
        <createIndex indexName="IXFK_POSITION_CODE_CODE01"
                     tableName="POSITION_CODE"
                     unique="false">
            <column name="CODE" type="VARCHAR2(100)"/>
        </createIndex>
        <rollback>
            <dropIndex tableName="POSITION_CODE" indexName="IXFK_POSITION_CODE_CODE01" />
        </rollback>
    </changeSet>

    <!-- POSITION_CODE -->

    <!-- POSITION_NOM -->
    <changeSet id="CONTINGENT2-NSI-2" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="POSITION_NOM"/>
            </not>
        </preConditions>
        <comment>Создание таблицы POSITION_NOM</comment>
        <createTable tableName="POSITION_NOM"
                     remarks="Номенклатура должностей медицинских организаций, оказывающих первичную медико-санитарную помощь">
            <column name="ID" type="BIGINT">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="CODE" type="VARCHAR2(100)">
                <constraints nullable="false" />
            </column>
            <column name="TITLE" type="VARCHAR2(1000)">
                <constraints nullable="false" />
            </column>
            <column name="START" type="TIMESTAMP(6)" remarks="Дата начала работы на участке">
                <constraints nullable="false" />
            </column>
            <column name="END" type="TIMESTAMP(6)" remarks="Дата окончания работы на участке" />
            <column name="SPECIALIZATION_ID" type="BIGINT" />
            <column name="ARCHIVED" type="NUMBER(1)" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="POSITION_NOM"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-2-1" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="SPECIALIZATION" columnName="ID" />
            <columnExists tableName="POSITION_NOM" columnName="SPECIALIZATION_ID" />
        </preConditions>
        <comment>Создание внешнего ключа FK_POSITION_NOM_SPECIALIZATION_01</comment>
        <addForeignKeyConstraint baseColumnNames="SPECIALIZATION_ID"
                                 baseTableName="POSITION_NOM"
                                 constraintName="FK_POSITION_NOM_SPECIALIZATION_01"
                                 referencedColumnNames="ID"
                                 referencedTableName="SPECIALIZATION"/>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-2-2" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IXFK_POSITION_NOM_SPECIALIZATIONO01"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки SPECIALIZATION_ID таблицы POSITION_NOM</comment>
        <createIndex indexName="IXFK_POSITION_NOM_SPECIALIZATIONO01"
                     tableName="POSITION_NOM"
                     unique="false">
            <column name="SPECIALIZATION_ID" type="BIGINT"/>
        </createIndex>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-2-3" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="POSITION_NOM" columnName="CODE" />
        </preConditions>
        <dropColumn columnName="CODE" tableName="POSITION_NOM" />
        <rollback>
            <addColumn tableName="POSITION_NOM">
                <column name="CODE" type="VARCHAR2(100)">
                    <constraints nullable="false" />
                </column>
            </addColumn>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-2-3-1" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="POSITION_NOM" columnName="ARCHIVED" />
        </preConditions>
        <dropColumn columnName="ARCHIVED" tableName="POSITION_NOM" />
        <rollback>
            <addColumn tableName="POSITION_NOM">
                <column name="ARCHIVED" type="NUMBER(1)">
                    <constraints nullable="false" />
                </column>
            </addColumn>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-2-3-2" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="POSITION_NOM" columnName="POSITION_CODE_ID" />
            </not>
        </preConditions>
        <addColumn tableName="POSITION_NOM">
            <column name="POSITION_CODE_ID" type="BIGINT" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </addColumn>
        <rollback>
            <dropColumn columnName="POSITION_CODE_ID" tableName="POSITION_NOM" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-2-3-3" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="POSITION_NOM" columnName="GLOBAL_ID" />
            </not>
        </preConditions>
        <renameColumn
                newColumnName="GLOBAL_ID"
                oldColumnName="ID"
                tableName="POSITION_NOM" />
        <rollback>
            <dropColumn columnName="POSITION_CODE_ID" tableName="POSITION_NOM" />
        </rollback>
    </changeSet>
    <!-- !!!! POSITION_NOM !!!! -->

    <!-- AREA_TYPES_CLASS -->
    <changeSet id="CONTINGENT2-NSI-3" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="AREA_TYPES_CLASS"/>
            </not>
        </preConditions>
        <comment>Создание таблицы AREA_TYPES_CLASS</comment>
        <createTable tableName="AREA_TYPES_CLASS">
            <column name="CODE" type="BIGINT">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="TITLE" type="VARCHAR2(255)" />
            <column name="ARCHIVED" type="NUMBER(1)" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="AREA_TYPES_CLASS"/>
        </rollback>
    </changeSet>

    <!-- !!!! AREA_TYPES_CLASS !!!! -->

    <!-- AREA_TYPES_KIND -->
    <changeSet id="CONTINGENT2-NSI-4" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="AREA_TYPES_KIND"/>
            </not>
        </preConditions>
        <comment>Создание таблицы AREA_TYPES_KIND</comment>
        <createTable tableName="AREA_TYPES_KIND">
            <column name="CODE" type="BIGINT">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="TITLE" type="VARCHAR2(255)" />
            <column name="ARCHIVED" type="NUMBER(1)" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="AREA_TYPES_KIND"/>
        </rollback>
    </changeSet>

    <!-- !!!! AREA_TYPES_KIND !!!! -->

    <!-- AREA_TYPE -->
    <changeSet id="CONTINGENT2-NSI-5" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="AREA_TYPE"/>
            </not>
        </preConditions>
        <comment>Создание таблицы AREA_TYPE</comment>
        <createTable tableName="AREA_TYPE"
                     remarks="Тип участка">
            <column name="CODE" type="BIGINT" remarks="Код типа участка">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="TITLE" type="VARCHAR2(100)" />
            <column name="AREA_TYPE_KIND_CODE" type="BIGINT" />
            <column name="AREA_TYPE_CLASS_CODE" type="BIGINT" remarks="Класс типа участка. Код" />
            <column name="HEAD_FINANCE" type="NUMBER(1)" remarks="Поголовное финансирование"/>
            <column name="ATTACH_BY_MEDICAL_REASON" type="NUMBER(1)" remarks="Прикрепление по медицинским показаниям"/>
            <column name="HAS_SERVICE_TERRITORY" type="NUMBER(1)" remarks="Наличие территории обслуживания"/>
            <column name="ATTACH_BY_REQUEST" type="NUMBER(1)" remarks="Прикрепление по заявлению"/>
            <column name="MPGU_AVAILABLE" type="NUMBER(1)" remarks="Возможно прикрепление через МПГУ"/>
            <column name="AREA_COUNT_LIMIT_CODE" type="NUMBER(4)" remarks="Ограничение количества участков"/>
            <column name="GENDER_CODE" type="VARCHAR2(1)" remarks="Пол, 0 - любой, 1 - м, 2- ж" />
            <column name="RESIDENTS_BIND_RATE" type="NUMBER(8)" remarks="Норма прикрепления	" />
            <column name="AGE_MIN" type="SMALLINT" remarks="Возраст мин" />
            <column name="AGE_MAX" type="SMALLINT" remarks="Возраст макс" />
            <column name="AGE_M_MIN" type="SMALLINT" remarks="Возраст М мин" />
            <column name="AGE_M_MAX" type="SMALLINT" remarks="Возраст М макс" />
            <column name="AGE_W_MIN" type="SMALLINT" remarks="Возраст Ж мин" />
            <column name="AGE_W_MAX" type="SMALLINT" remarks="Возраст Ж макс" />
            <column name="ARCHIVED" type="NUMBER(1)" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="AREA_TYPE"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-5-1" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IXFK_AREA_TYPE_CLASS_ARE01"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки AREA_TYPE_CLASS_CODE таблицы AREA_TYPE</comment>
        <createIndex indexName="IXFK_AREA_TYPE_CLASS_ARE01"
                     tableName="AREA_TYPE"
                     unique="false">
            <column name="AREA_TYPE_CLASS_CODE" type="BIGINT"/>
        </createIndex>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-5-2" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IXFK_AREA_TYPE_KIND_AREA01"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки AREA_TYPE_KIND_CODE таблицы AREA_TYPE</comment>
        <createIndex indexName="IXFK_AREA_TYPE_KIND_AREA01"
                     tableName="AREA_TYPE"
                     unique="false">
            <column name="AREA_TYPE_KIND_CODE" type="BIGINT"/>
        </createIndex>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-5-3" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE" columnName="AREA_TYPE_CLASS_CODE" />
            <columnExists tableName="AREA_TYPES_CLASS" columnName="CODE" />
        </preConditions>
        <comment>Создание внешнего ключа FK_AREA_AREA_TYPE_CLASS_TYPES</comment>
        <addForeignKeyConstraint baseColumnNames="AREA_TYPE_CLASS_CODE"
                                 baseTableName="AREA_TYPE"
                                 constraintName="FK_AREA_AREA_TYPE_CLASS_TYPES"
                                 referencedColumnNames="CODE"
                                 referencedTableName="AREA_TYPES_CLASS"/>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-5-4" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE" columnName="AREA_TYPE_KIND_CODE" />
            <columnExists tableName="AREA_TYPES_KIND" columnName="CODE" />
        </preConditions>
        <comment>Создание внешнего ключа FK_AREA_TYPE_AREA_TYPES_KIND</comment>
        <addForeignKeyConstraint baseColumnNames="AREA_TYPE_KIND_CODE"
                                 baseTableName="AREA_TYPE"
                                 constraintName="FK_AREA_AREA_TYPE_KIND_TYPES"
                                 referencedColumnNames="CODE"
                                 referencedTableName="AREA_TYPES_KIND"/>
    </changeSet>

    <!-- !!!! AREA_TYPE !!!! -->

    <!-- AREA_TYPE_MEDICAL_POSITIONS -->
    <changeSet id="CONTINGENT2-NSI-6" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="AREA_TYPE_MEDICAL_POSITIONS"/>
            </not>
        </preConditions>
        <comment>Создание таблицы AREA_TYPE_MEDICAL_POSITIONS</comment>
        <createTable tableName="AREA_TYPE_MEDICAL_POSITIONS"
                     remarks="Должности МР на типе участка">
            <column name="ID" type="BIGINT">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="AREA_TYPE_CODE" type="BIGINT" remarks="Тип участка. Код" />
            <column name="POSITION_CODE" type="BIGINT" />
            <column name="ARCHIVED" type="NUMBER(1)" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="AREA_TYPE_MEDICAL_POSITIONS"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-6-1" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IXFK_AREA_TYPE_ME_POSITIO01"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки POSITION_NOM_ID таблицы AREA_TYPE_MEDICAL_POSITIONS</comment>
        <createIndex indexName="IXFK_AREA_TYPE_ME_POSITIO01"
                     tableName="AREA_TYPE_MEDICAL_POSITIONS"
                     unique="false">
            <column name="POSITION_CODE" type="number"/>
        </createIndex>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-6-2" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IXFK_AREA_TYPE_MEDI_AREA_01"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки AREA_TYPE_CODE таблицы AREA_TYPE_MEDICAL_POSITIONS</comment>
        <createIndex indexName="IXFK_AREA_TYPE_MEDI_AREA_01"
                     tableName="AREA_TYPE_MEDICAL_POSITIONS"
                     unique="false">
            <column name="AREA_TYPE_CODE" type="number"/>
        </createIndex>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-6-4" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE_MEDICAL_POSITIONS" columnName="AREA_TYPE_CODE" />
            <columnExists tableName="AREA_TYPE" columnName="CODE" />
        </preConditions>
        <comment>Создание внешнего ключа FK_AREA_TYPE_MEDI_AREA_TYPE</comment>
        <addForeignKeyConstraint baseColumnNames="AREA_TYPE_CODE"
                                 baseTableName="AREA_TYPE_MEDICAL_POSITIONS"
                                 constraintName="FK_AREA_TYPE_MEDI_AREA_TYPE"
                                 referencedColumnNames="CODE"
                                 referencedTableName="AREA_TYPE"/>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-6-5-0" author="ddryuchin" labels="1.0.0.0">
        <delete tableName="AREA_TYPE_MEDICAL_POSITIONS" />
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-6-5" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="AREA_TYPE_MEDICAL_POSITIONS" columnName="POSITION_NOM_ID" />
            </not>
        </preConditions>
        <addColumn tableName="AREA_TYPE_MEDICAL_POSITIONS">
            <column name="POSITION_NOM_ID" type="BIGINT" />
        </addColumn>
        <rollback>
            <dropColumn tableName="AREA_TYPE_MEDICAL_POSITIONS" columnName="POSITION_NOM_ID" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-6-5-1" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IXFK_ATMP_PNGI_01"/>
            </not>
        </preConditions>
        <createIndex indexName="IXFK_ATMP_PNGI_01"
                     tableName="AREA_TYPE_MEDICAL_POSITIONS"
                     unique="false">
            <column name="POSITION_NOM_ID" type="BIGINT"/>
        </createIndex>
        <rollback>
            <dropIndex indexName="IXFK_ATMP_PNGI_01"
                       tableName="AREA_TYPE_MEDICAL_POSITIONS" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-6-5-2" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE_MEDICAL_POSITIONS" columnName="POSITION_NOM_ID" />
            <columnExists tableName="POSITION_NOM" columnName="GLOBAL_ID" />
        </preConditions>
        <addForeignKeyConstraint baseColumnNames="POSITION_NOM_ID"
                                 baseTableName="AREA_TYPE_MEDICAL_POSITIONS"
                                 constraintName="FK_ATMP_PNGI"
                                 referencedColumnNames="GLOBAL_ID"
                                 referencedTableName="POSITION_NOM"/>
        <rollback>
            <dropForeignKeyConstraint baseTableName="AREA_TYPE_MEDICAL_POSITIONS" constraintName="FK_ATMP_PNGI"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-206-1-2" author="mkachalov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <tableExists tableName="AREA_TYPE_MEDICAL_POSITIONS"/>
        </preConditions>
        <comment>Изменение типа данных в таблице AREA_TYPE_MEDICAL_POSITIONS</comment>
        <modifyDataType tableName="AREA_TYPE_MEDICAL_POSITIONS" columnName="POSITION_CODE" newDataType="VARCHAR2(100)"/>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-6-5-4" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE_MEDICAL_POSITIONS" columnName="POSITION_CODE" />
            <columnExists tableName="POSITION_CODE" columnName="CODE" />
            <not>
                <foreignKeyConstraintExists foreignKeyName="FK_ATMP_PCC"/>
            </not>
        </preConditions>
        <addForeignKeyConstraint baseColumnNames="POSITION_CODE "
                                 baseTableName="AREA_TYPE_MEDICAL_POSITIONS"
                                 constraintName="FK_ATMP_PCC"
                                 referencedColumnNames="CODE"
                                 referencedTableName="POSITION_CODE"/>
        <rollback>
            <dropForeignKeyConstraint baseTableName="AREA_TYPE_MEDICAL_POSITIONS" constraintName="FK_ATMP_PCC"/>
        </rollback>
    </changeSet>

    <!-- !!!! AREA_TYPE_MEDICAL_POSITIONS !!!! -->

    <!-- !!!! AREA_TYPE_RELATIONS !!!! -->
    <changeSet id="CONTINGENT2-NSI-7" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="AREA_TYPE_RELATIONS"/>
            </not>
        </preConditions>
        <comment>Создание таблицы AREA_TYPE_RELATIONS</comment>
        <createTable tableName="AREA_TYPE_RELATIONS"
                     remarks="Связь зависимых и первичных">
            <column name="ID" type="BIGINT">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="DEPENDENT_AREA_TYPE_CODE" type="BIGINT" remarks="Код зависимого типа участка">
                <constraints nullable="false" />
            </column>
            <column name="PRIMARY_AREA_TYPE_CODE" type="BIGINT" remarks="Код первичного типа участка">
                <constraints nullable="false" />
            </column>
            <column name="ARCHIVED" type="NUMBER(1)" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="AREA_TYPE_RELATIONS"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-7-1" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IXFK_AREA_TYPE_RELA_AREA_DEP"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки DEPENDENT_AREA_TYPE_CODE таблицы AREA_TYPE_RELATIONS</comment>
        <createIndex indexName="IXFK_AREA_TYPE_RELA_AREA_DEP"
                     tableName="AREA_TYPE_RELATIONS"
                     unique="false">
            <column name="DEPENDENT_AREA_TYPE_CODE" type="number"/>
        </createIndex>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-7-2" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IXFK_AREA_TYPE_RELA_AREA_PRIM"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки PRIMARY_AREA_TYPE_CODE таблицы AREA_TYPE_RELATIONS</comment>
        <createIndex indexName="IXFK_AREA_TYPE_RELA_AREA_PRIM"
                     tableName="AREA_TYPE_RELATIONS"
                     unique="false">
            <column name="PRIMARY_AREA_TYPE_CODE" type="number"/>
        </createIndex>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-7-3" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE_RELATIONS" columnName="DEPENDENT_AREA_TYPE_CODE" />
            <columnExists tableName="AREA_TYPE" columnName="CODE" />
        </preConditions>
        <comment>Создание внешнего ключа FK_AREA_TYPE_REL_AREA_TYPE_DEP</comment>
        <addForeignKeyConstraint baseColumnNames="DEPENDENT_AREA_TYPE_CODE"
                                 baseTableName="AREA_TYPE_RELATIONS"
                                 constraintName="FK_AREA_TYPE_REL_AREA_TYPE_DEP"
                                 referencedColumnNames="CODE"
                                 referencedTableName="AREA_TYPE"/>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-7-4" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE_RELATIONS" columnName="PRIMARY_AREA_TYPE_CODE" />
            <columnExists tableName="AREA_TYPE" columnName="CODE" />
        </preConditions>
        <comment>Создание внешнего ключа FK_AREA_TYPE_REL_AREA_TYPE_PRI</comment>
        <addForeignKeyConstraint baseColumnNames="PRIMARY_AREA_TYPE_CODE"
                                 baseTableName="AREA_TYPE_RELATIONS"
                                 constraintName="FK_AREA_TYPE_REL_AREA_TYPE_PRI"
                                 referencedColumnNames="CODE"
                                 referencedTableName="AREA_TYPE"/>
    </changeSet>

    <!-- !!!! AREA_TYPE_RELATIONS !!!! -->


    <!-- POLICY_TYPE -->
    <changeSet id="CONTINGENT2-NSI-9" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="POLICY_TYPE"/>
            </not>
        </preConditions>
        <comment>Создание таблицы POLICY_TYPE</comment>
        <createTable tableName="POLICY_TYPE"
                     remarks="Тип полиса">
            <column name="CODE" type="BIGINT" >
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="TITLE" type="VARCHAR2(100)">
                <constraints nullable="false" />
            </column>
            <column name="ARCHIVED" type="NUMBER(1)" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="POLICY_TYPE"/>
        </rollback>
    </changeSet>
    <!-- !!!! POLICY_TYPE !!!! -->

    <!-- NSI_BUILDING_REGISTRY -->
    <changeSet id="CONTINGENT2-NSI-10" author="sorlov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="NSI_BUILDING_REGISTRY"/>
            </not>
        </preConditions>
        <comment>Создание таблицы NSI_BUILDING_REGISTRY</comment>
        <createTable tableName="NSI_BUILDING_REGISTRY"
                     remarks="Сведения по отдельным зданиям, сооружениям">
            <column name="GLOBAL_ID" type="BIGINT" remarks="Уникальный идентификатор объекта" >
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="ADDR_ID" type="BIGINT" />
            <column name="L1_TYPE" type="VARCHAR2(256)" remarks="Тип номера дома, владения"/>
            <column name="L1_TYPE_SHORT" type="VARCHAR2(16)" remarks="Краткий тип номера дома, владения"/>
            <column name="L1_VALUE" type="VARCHAR2(256)" remarks="Номер дома, владения"/>
            <column name="L2_TYPE" type="VARCHAR2(256)" remarks="Тип номера корпуса"/>
            <column name="L2_TYPE_SHORT" type="VARCHAR2(16)" remarks="Краткий тип номера корпуса"/>
            <column name="L2_VALUE" type="VARCHAR2(256)" remarks="Номер корпуса"/>
            <column name="L3_TYPE" type="VARCHAR2(256)" remarks="Тип номера строения, сооружения"/>
            <column name="L3_TYPE_SHORT" type="VARCHAR2(16)" remarks="Краткий тип номера строения, сооружения"/>
            <column name="L3_VALUE" type="VARCHAR2(256)" remarks="Номер строения, сооружения"/>
            <column name="ADDRESS" type="VARCHAR2(4000)" remarks="Адрес" />
        </createTable>
        <rollback>
            <dropTable tableName="NSI_BUILDING_REGISTRY"/>
        </rollback>
    </changeSet>

    <!-- AREA_TYPE_SPECIALIZATIONS -->
    <changeSet id="CONTINGENT2-NSI-11" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="AREA_TYPE_SPECIALIZATIONS"/>
            </not>
        </preConditions>
        <comment>Создание таблицы AREA_TYPE_SPECIALIZATIONS</comment>
        <createTable tableName="AREA_TYPE_SPECIALIZATIONS">
            <column name="ID" type="BIGINT">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="AREA_TYPE_CODE" type="BIGINT" remarks="Тип участка">
                <constraints nullable="false" />
            </column>
            <column name="SPECIALIZATION_CODE" type="BIGINT" remarks="Код специальности">
                <constraints nullable="false" />
            </column>
            <column name="ARCHIVED" type="NUMBER(1)" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="AREA_TYPE_SPECIALIZATIONS"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-11-1" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE_SPECIALIZATIONS" columnName="AREA_TYPE_CODE" />
            <columnExists tableName="AREA_TYPE" columnName="CODE" />
        </preConditions>
        <comment>Создание внешнего ключа FK_ATS_ATC</comment>
        <addForeignKeyConstraint baseColumnNames="AREA_TYPE_CODE"
                                 baseTableName="AREA_TYPE_SPECIALIZATIONS"
                                 constraintName="FK_ATS_ATC"
                                 referencedColumnNames="CODE"
                                 referencedTableName="AREA_TYPE"/>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-11-2" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IDX_ATS_ATC"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки AREA_TYPE_CODE таблицы AREA_TYPE_SPECIALIZATIONS</comment>
        <createIndex indexName="IDX_ATS_ATC"
                     tableName="AREA_TYPE_SPECIALIZATIONS"
                     unique="false">
            <column name="AREA_TYPE_CODE" type="BIGINT"/>
        </createIndex>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-11-3" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IDX_ATS_SPEC_CODE"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки SPECIALIZATION_CODE таблицы AREA_TYPE_SPECIALIZATIONS</comment>
        <createIndex indexName="IDX_ATS_SPEC_CODE"
                     tableName="AREA_TYPE_SPECIALIZATIONS"
                     unique="false">
            <column name="SPECIALIZATION_CODE" type="BIGINT"/>
        </createIndex>
    </changeSet>

    <!-- !!!! AREA_TYPE_SPECIALIZATIONS !!!! -->

    <!-- GENDER -->
    <changeSet id="CONTINGENT2-NSI-12" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="GENDER"/>
            </not>
        </preConditions>
        <comment>Создание таблицы GENDER</comment>
        <createTable tableName="GENDER">
            <column name="CODE" type="VARCHAR2(50)" remarks="Код">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="TITLE" type="VARCHAR2(50)" remarks="Наименование">
                <constraints nullable="false" />
            </column>
            <column name="ARCHIVED" type="NUMBER(1)" defaultValue="0">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="GENDER"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-12-5" author="ddryuchin" labels="1.0.0.0">
        <modifyDataType columnName="CODE"
                        newDataType="VARCHAR(50)"
                        tableName="GENDER"/>
    </changeSet>

    <!-- !!!! GENDER !!!! -->

    <changeSet id="CONTINGENT2-NSI-12-1" author="shnaider_ab">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="SEQ_NSI_PUSH_LOG"/>
            </not>
        </preConditions>
        <comment>Создание сиквенса для таблицы NSI_PUSH_LOG</comment>
        <createSequence sequenceName="SEQ_NSI_PUSH_LOG"/>
        <rollback>
            <dropSequence sequenceName="SEQ_NSI_PUSH_LOG"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-12-2" author="shnaider_ab">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="NSI_PUSH_LOG"/>
            </not>
        </preConditions>
        <comment>Создание таблицы логирования входящих пуш запросов NSI_PUSH_LOG</comment>
        <createTable tableName="NSI_PUSH_LOG">
            <column name="id" type="BIGINT">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="in_type" type="VARCHAR2(100)"/>
            <column name="received_time" type="timestamp(6)" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false" />
            </column>
            <column name="in" type="text">
                <constraints nullable="false" />
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="NSI_PUSH_LOG"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-12-3" author="shnaider_ab">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="NSI_PUSH_LOG" columnName="input_message" />
            </not>
        </preConditions>
        <renameColumn newColumnName="input_message"
                      oldColumnName="in"
                      tableName="NSI_PUSH_LOG"/>
    </changeSet>

<!--
    <changeSet id="CONTINGENT2-NSI-13-1" author="ddryuchin"  labels="1.0.0.0">
        <comment>Заполнение справочника</comment>
        <loadData encoding="UTF-8" separator=";" tableName="POLICY_TYPE" file="changelog/area/versions/1.0.0.0/files/Тип полиса_POLICY_TYPE.csv">
            <column header="CODE" name="CODE" type="NUMERIC"/>
            <column header="TITLE" name="TITLE" type="string"/>
            <column header="archived" name="archived" type="NUMERIC"/>
        </loadData>
    </changeSet>
-->

<!--
    <changeSet id="CONTINGENT2-NSI-13-2" author="ddryuchin"  labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <and>
                <tableExists tableName="GENDER" />
                <sqlCheck expectedResult ="0">SELECT COUNT(*) GENDER</sqlCheck>
            </and>
        </preConditions>
        <comment>Заполнение справочника</comment>
        <loadData encoding="UTF-8" separator=";" tableName="GENDER" file="changelog/area/versions/1.0.0.0/files/Пол_GENDER.csv">
            <column header="system_object_id" name="id" type="NUMERIC"/>
            <column header="code" name="CODE" type="string"/>
            <column header="title" name="TITLE" type="string"/>
            <column header="archived" name="archived" type="NUMERIC"/>
        </loadData>
    </changeSet>
-->

<!--
    <changeSet id="CONTINGENT2-NSI-13-3" author="ddryuchin"  labels="1.0.0.0" >
        <comment>Заполнение справочника</comment>
        <loadData encoding="UTF-8" separator=";" tableName="SPECIALIZATION" file="changelog/area/versions/1.0.0.0/files/Медицинская специализация_SPECIALIZATION.csv">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="code" name="CODE" type="NUMERIC"/>
            <column header="title" name="TITLE" type="string"/>
            <column header="archived" name="archived" type="NUMERIC"/>
        </loadData>
    </changeSet>
-->

<!--
    <changeSet id="CONTINGENT2-NSI-13-4" author="ddryuchin"  labels="1.0.0.0">
        <comment>Заполнение справочника</comment>
        <loadData encoding="UTF-8" separator=";" tableName="AREA_TYPES_CLASS" file="changelog/area/versions/1.0.0.0/files/Классы типа участка_AREA_TYPES_CLASS.csv">
            <column header="CODE" name="CODE" type="NUMERIC"/>
            <column header="TITLE" name="TITLE" type="string"/>
            <column header="archived" name="archived" type="NUMERIC"/>
        </loadData>
    </changeSet>
-->

<!--
    <changeSet id="CONTINGENT2-NSI-13-5" author="ddryuchin"  labels="1.0.0.0">
        <comment>Заполнение справочника</comment>
        <loadData encoding="UTF-8" separator=";" tableName="AREA_TYPES_KIND" file="changelog/area/versions/1.0.0.0/files/Вид типа участка_AREA_TYPES_KIND.csv">
            <column header="CODE" name="CODE" type="NUMERIC"/>
            <column header="TITLE" name="TITLE" type="string"/>
            <column header="archived" name="archived" type="NUMERIC"/>
        </loadData>
    </changeSet>
-->

<!--
    <changeSet id="CONTINGENT2-191-NSI-1" author="mkachalov"  labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <and>
                <tableExists tableName="AREA_TYPE" />
                &lt;!&ndash; <sqlCheck expectedResult ="0">SELECT COUNT(*) FROM AREA_TYPE</sqlCheck> &ndash;&gt;
            </and>
        </preConditions>
        <comment>Заполнение справочника</comment>
        <loadData encoding="UTF-8" separator=";" tableName="AREA_TYPE" file="changelog/area/versions/1.0.0.0/files/AREA_TYPE.csv">
            <column header="CODE" name="CODE" type="NUMERIC"/>
            <column header="TITLE" name="TITLE" type="string"/>
            <column header="AREA_TYPE_KIND_CODE" name="AREA_TYPE_KIND_CODE" type="NUMERIC"/>
            <column header="AREA_TYPE_CLASS_CODE" name="AREA_TYPE_CLASS_CODE" type="NUMERIC"/>
            <column header="GENDER_CODE" name="GENDER_CODE" type="STRING"/>
            <column header="AGE_MIN" name="AGE_MIN" type="NUMERIC"/>
            <column header="AGE_MAX" name="AGE_MAX" type="NUMERIC"/>
            <column header="AGE_M_MIN" name="AGE_M_MIN" type="NUMERIC"/>
            <column header="AGE_M_MAX" name="AGE_M_MAX" type="NUMERIC"/>
            <column header="AGE_W_MIN" name="AGE_W_MIN" type="NUMERIC"/>
            <column header="AGE_W_MAX" name="AGE_W_MAX" type="NUMERIC"/>
            <column header="HEAD_FINANCE" name="HEAD_FINANCE" type="NUMERIC"/>
            <column header="HAS_SERVICE_TERRITORY" name="HAS_SERVICE_TERRITORY" type="NUMERIC"/>
            <column header="ATTACH_BY_REQUEST" name="ATTACH_BY_REQUEST" type="NUMERIC"/>
            <column header="ATTACH_BY_MEDICAL_REASON" name="ATTACH_BY_MEDICAL_REASON" type="NUMERIC"/>
            <column header="MPGU_AVAILABLE" name="MPGU_AVAILABLE" type="NUMERIC"/>
            <column header="RESIDENTS_BIND_RATE" name="RESIDENTS_BIND_RATE" type="NUMERIC"/>
            <column header="AREA_COUNT_LIMIT_CODE" name="AREA_COUNT_LIMIT_CODE" type="NUMERIC"/>
            <column header="ARCHIVED" name="ARCHIVED" type="NUMERIC"/>
        </loadData>
        <rollback>
            <sql>
                DELETE FROM AREA_TYPE;
            </sql>
        </rollback>
    </changeSet>
-->

<!--
    <changeSet id="CONTINGENT2-191-NSI-2" author="mkachalov"  labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <and>
                <tableExists tableName="AREA_TYPE_SPECIALIZATIONS" />
                <sqlCheck expectedResult ="0">SELECT COUNT(*) FROM AREA_TYPE_SPECIALIZATIONS</sqlCheck>
            </and>
        </preConditions>
        <comment>Заполнение справочника</comment>
        <loadData encoding="UTF-8" separator=";" tableName="AREA_TYPE_SPECIALIZATIONS" file="changelog/area/versions/1.0.0.0/files/AREA_TYPE_SPECIALIZATIONS.csv">
            <column header="ID" name="ID" type="NUMERIC"/>
            <column header="AREA_TYPE_CODE" name="AREA_TYPE_CODE" type="NUMERIC"/>
            <column header="SPECIALIZATION_CODE" name="SPECIALIZATION_CODE" type="NUMERIC"/>
            <column header="ARCHIVED" name="ARCHIVED" type="NUMERIC"/>
        </loadData>
        <rollback>
            <sql>
                DELETE FROM AREA_TYPE_SPECIALIZATIONS;
            </sql>
        </rollback>
    </changeSet>
-->


    <!-- Тут начинается фигня которую лучше бы сразу при создании таблицы POSITION_NOM учесть -->

    <!-- Констрэйнт удален в связи с отсутствием соответствующего ограничения (Катерина Рымова) -->
    <changeSet id="CONTINGENT2-191-NSI-3" author="mkachalov"  labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <tableExists tableName="POSITION_NOM" />
        </preConditions>
        <dropNotNullConstraint columnDataType="DATE" columnName="START" tableName="POSITION_NOM"/>
    </changeSet>


    <changeSet id="CONTINGENT2-191-NSI-4-2" author="mkachalov"  labels="1.0.0.0" objectQuotingStrategy="QUOTE_ALL_OBJECTS">
        <preConditions onFail="MARK_RAN">
            <and>
                <tableExists tableName="position_nom" />
                <sqlCheck expectedResult ="1">SELECT COUNT(column_name) FROM information_schema.columns WHERE table_name='position_nom' AND column_name='END'</sqlCheck>
            </and>
        </preConditions>
        <renameColumn columnDataType="TIMESTAMP(6)" newColumnName="p_end" oldColumnName="END" tableName="position_nom"/>
    </changeSet>

    <changeSet id="CONTINGENT2-206-3-1" author="mkachalov"  labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <and>
                <tableExists tableName="position_nom" />
                <columnExists tableName="position_nom" columnName="p_end" />
            </and>
        </preConditions>
        <renameColumn columnDataType="TIMESTAMP(6)" newColumnName="end_date" oldColumnName="p_end" tableName="position_nom"  remarks="Дата окончания действия"/>
    </changeSet>

    <changeSet id="CONTINGENT2-206-3-2" author="mkachalov"  labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <and>
                <tableExists tableName="position_nom" />
                <columnExists tableName="position_nom" columnName="start" />
            </and>
        </preConditions>
        <renameColumn columnDataType="TIMESTAMP(6)" newColumnName="start_date" oldColumnName="start" tableName="position_nom" remarks="Дата начала действия"/>
    </changeSet>

    <!-- Тут крнчается фигня которую лучше бы сразу при создании таблицы POSITION_NOM учесть -->


<!-- Не накатывает на чистой базе, ругается на отсутствующие поля -->
<!--    <changeSet id="CONTINGENT2-191-NSI-4" author="mkachalov"  labels="1.0.0.0">-->
<!--        <preConditions onFail="MARK_RAN">-->
<!--            <and>-->
<!--                <tableExists tableName="POSITION_NOM" />-->
<!--                <sqlCheck expectedResult ="0">SELECT COUNT(*) FROM POSITION_NOM</sqlCheck>-->
<!--            </and>-->
<!--        </preConditions>-->
<!--        <comment>Заполнение справочника POSITION_NOM</comment>-->
<!--        <loadData encoding="UTF-8" separator=";" tableName="POSITION_NOM" file="changelog/area/versions/1.0.0.0/files/POSITION_NOM.csv">-->
<!--            <column header="ID" name="ID" type="NUMERIC"/>-->
<!--            <column header="CODE" name="CODE" type="STRING"/>-->
<!--            <column header="TITLE" name="TITLE" type="STRING"/>-->
<!--            <column header="START" name="start_date" type="DATE"/>-->
<!--            <column header="END" name="end_date" type="DATE"/>-->
<!--            <column header="SPECIALIZATION_ID" name="SPECIALIZATION_ID" type="NUMERIC"/>-->
<!--            <column header="ARCHIVED" name="ARCHIVED" type="NUMERIC"/>-->
<!--        </loadData>-->
<!--        <rollback>-->
<!--            <sql>-->
<!--                DELETE FROM POSITION_NOM;-->
<!--            </sql>-->
<!--        </rollback>-->
<!--    </changeSet>-->


<!-- Уже есть: CONTINGENT2-NSI-6-5-3 -->
<!--    <changeSet id="CONTINGENT2-206-1-1" author="mkachalov" labels="1.0.0.0">-->
<!--        <preConditions onFail="MARK_RAN">-->
<!--            <tableExists tableName="AREA_TYPE_MEDICAL_POSITIONS"/>-->
<!--        </preConditions>-->
<!--        <dropForeignKeyConstraint baseTableName="AREA_TYPE_MEDICAL_POSITIONS" constraintName="fk_area_type_me_position_no_01"/>-->
<!--    </changeSet>-->

    <!--    CONTINGENT2-280 -->
    <!--    <changeSet id="CONTINGENT2-191-NSI-5" author="mkachalov"  labels="1.0.0.0">-->
    <!--	<preConditions onFail="MARK_RAN">-->
    <!--             <and>-->
    <!--                    <tableExists tableName="AREA_TYPE_MEDICAL_POSITIONS" />		-->
    <!--                    <sqlCheck expectedResult ="0">SELECT COUNT(*) FROM AREA_TYPE_MEDICAL_POSITIONS</sqlCheck>-->
    <!--             </and>-->
    <!--	</preConditions>-->
    <!--        <comment>Заполнение справочника</comment>	-->
    <!--        <loadData encoding="UTF-8" separator=";" tableName="AREA_TYPE_MEDICAL_POSITIONS" file="changelog/area/versions/1.0.0.0/files/AREA_TYPE_MEDICAL_POSITIONS.csv">-->
    <!--            <column header="ID" name="ID" type="NUMERIC"/>-->
    <!--            <column header="AREA_TYPE_CODE" name="AREA_TYPE_CODE" type="NUMERIC"/>-->
    <!--            <column header="POSITION_CODE" name="POSITION_CODE" type="STRING"/>-->
    <!--            <column header="ARCHIVED" name="ARCHIVED" type="NUMERIC"/>-->
    <!--        </loadData>-->
    <!--        <rollback>-->
    <!--            <sql>-->
    <!--               DELETE FROM AREA_TYPE_MEDICAL_POSITIONS;-->
    <!--            </sql>-->
    <!--        </rollback>-->
    <!--    </changeSet>-->

    <changeSet id="CONTINGENT2-NSI-12-4" author="shnaider_ab">
        <preConditions onFail="MARK_RAN">
            <tableExists tableName="NSI_PUSH_LOG"/>
            <not>
                <columnExists tableName="NSI_PUSH_LOG" columnName="error"/>
            </not>
        </preConditions>
        <comment>Добавление колонки status в таблицу логирования входящих пуш запросов NSI_PUSH_LOG</comment>
        <addColumn tableName="NSI_PUSH_LOG">
            <column name="error" type="NUMBER(1)"/>
        </addColumn>
        <rollback>
            <dropColumn columnName="error" tableName="NSI_PUSH_LOG"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-12-5" author="shnaider_ab">
        <preConditions onFail="MARK_RAN">
            <tableExists tableName="NSI_PUSH_LOG"/>
            <not>
                <columnExists tableName="NSI_PUSH_LOG" columnName="error_message"/>
            </not>
        </preConditions>
        <comment>Добавление колонки error в таблицу логирования входящих пуш запросов NSI_PUSH_LOG</comment>
        <addColumn tableName="NSI_PUSH_LOG">
            <column name="error_message" type="text"/>
        </addColumn>
        <rollback>
            <dropColumn columnName="error_message" tableName="NSI_PUSH_LOG"/>
        </rollback>
    </changeSet>

    <!-- ADDRESS_FORMING_ELEMENT -->
    <changeSet id="CONTINGENT2-303-1" author="shnaider_ab" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="NSI_ADDRESS_FORMING_ELEMENT"/>
            </not>
        </preConditions>
        <comment>Создание таблицы NSI_ADDRESS_FORMING_ELEMENT</comment>
        <createTable tableName="NSI_ADDRESS_FORMING_ELEMENT"
                     remarks="Адресообразующий элемент">
            <column name="GLOBAL_ID" type="BIGINT" remarks="Уникальный идентификатор объекта">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="KOD_GIVZ" type="VARCHAR2(11)" remarks="Код БТИ"/>
            <column name="AOLEVEL" type="VARCHAR2(2)" remarks="Уровень адресного объекта"/>
            <column name="REGION_TE_CODE" type="VARCHAR2(4000)" remarks="Код округа ОМК ТЕ"/>
            <column name="REGION_TE_NAME" type="VARCHAR2(4000)" remarks="Официальное наименование округа"/>
            <column name="REGION_TE_TYPENAME" type="VARCHAR2(256)" remarks="Наименование типа округа"/>
            <column name="REGION_TE_TYPENAME_SHORT" type="VARCHAR2(256)" remarks="Краткое наименование типа округа"/>
            <column name="AREACODE_OMK_TE" type="VARCHAR2(4000)" remarks="Код района ОМК ТЕ"/>
            <column name="AREA_TE_NAME" type="VARCHAR2(4000)" remarks="Официальное наименование муниципального образования"/>
            <column name="AREA_TE_TYPENAME" type="VARCHAR2(128)" remarks="Наименование типа муниципального образования"/>
            <column name="AREA_TE_TYPENAME_SHORT" type="VARCHAR2(128)" remarks="Краткое наименование типа муниципального образования"/>
            <column name="AREACODE" type="VARCHAR2(3)" remarks="Код района"/>
            <column name="AREA_BTI_CODE" type="VARCHAR2(11)" remarks="БТИ код района"/>
            <column name="AREA_NAME" type="VARCHAR2(4000)" remarks="Официальное наименование района"/>
            <column name="AREA_TYPENAME" type="VARCHAR2(128)" remarks="Наименование типа района"/>
            <column name="AREA_TYPENAME_SHORT" type="VARCHAR2(128)" remarks="Наименование типа района"/>
            <column name="CITYCODE" type="VARCHAR2(3)" remarks="Код города"/>
            <column name="CITY_BTI_CODE" type="VARCHAR2(11)" remarks="БТИ код города"/>
            <column name="CITY_NAME" type="VARCHAR2(4000)" remarks="Официальное наименование города"/>
            <column name="CITY_TYPENAME" type="VARCHAR2(128)" remarks="Наименование типа города"/>
            <column name="CITY_TYPENAME_SHORT" type="VARCHAR2(128)" remarks="Наименование типа города"/>
            <column name="PLACECODE" type="VARCHAR2(3)" remarks="Код населенного пункта"/>
            <column name="PLACE_BTI_CODE" type="VARCHAR2(11)" remarks="БТИ код населённого пункта"/>
            <column name="PLACE_NAME" type="VARCHAR2(4000)" remarks="Официальное наименование населённого пункта"/>
            <column name="PLACE_TYPENAME" type="VARCHAR2(128)" remarks="Наименование типа населенного пункта"/>
            <column name="PLACE_TYPENAME_SHORT" type="VARCHAR2(128)" remarks="Наименование типа населенного пункта"/>
            <column name="PLANCODE" type="VARCHAR2(4)" remarks="Код элемента планировочной структуры"/>
            <column name="PLAN_BTI_CODE" type="VARCHAR2(11)" remarks="БТИ код элемента планировочной структуры"/>
            <column name="PLAN_NAME" type="VARCHAR2(4000)" remarks="Официальное наименование элемента планировочной структуры"/>
            <column name="PLAN_TYPENAME" type="VARCHAR2(128)" remarks="Наименование типа элемента планировочной структуры"/>
            <column name="PLAN_TYPENAME_SHORT" type="VARCHAR2(128)" remarks="Наименование типа элемента планировочной структуры"/>
            <column name="STREETCODE" type="VARCHAR2(4)" remarks="Код улицы"/>
            <column name="STREET_BTI_CODE" type="VARCHAR2(11)" remarks="БТИ код улицы"/>
            <column name="STREET_NAME" type="VARCHAR2(4000)" remarks="Официальное наименование улицы"/>
            <column name="STREET_OMK_UM" type="VARCHAR2(10)" remarks="Код ОМК УМ улицы"/>
            <column name="STREET_TYPENAME" type="VARCHAR2(128)" remarks="Наименование типа улицы"/>
            <column name="STREET_TYPENAME_SHORT" type="VARCHAR2(128)" remarks="Наименование типа улицы"/>
            <column name="ADDRESS" type="VARCHAR2(4000)" remarks="Полное наименование адресообразующего элемента">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <rollback>
            <dropTable tableName="NSI_ADDRESS_FORMING_ELEMENT"/>
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-8-1" author="ddryuchin" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists indexName="IXFK_AFE_GLOBAL_ID"/>
            </not>
        </preConditions>
        <comment>Создание индекса колонки GLOBAL_ID таблицы ADDRESS_FORMING_ELEMENT</comment>
        <createIndex indexName="IXFK_AFE_GLOBAL_ID"
                     tableName="NSI_ADDRESS_FORMING_ELEMENT"
                     unique="false">
            <column name="GLOBAL_ID" type="BIGINT"/>
        </createIndex>
    </changeSet>
    <!-- !!!! ADDRESS_FORMING_ELEMENT !!!! -->

    <changeSet id="CONTINGENT2-306-1" author="shnaider_ab" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="AREA_TYPE" columnName="GLOBAL_ID" />
            </not>
        </preConditions>
        <comment>Создание колонки GLOBAL_ID</comment>
        <addColumn tableName="AREA_TYPE">
            <column name="GLOBAL_ID" type="BIGINT">
                <constraints nullable="false" unique="true" />
            </column>
        </addColumn>
        <rollback>
            <dropColumn tableName="AREA_TYPE" columnName="GLOBAL_ID" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-306-2" author="shnaider_ab" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="AREA_TYPES_CLASS" columnName="GLOBAL_ID" />
            </not>
        </preConditions>
        <comment>Создание колонки GLOBAL_ID</comment>
        <addColumn tableName="AREA_TYPES_CLASS">
            <column name="GLOBAL_ID" type="BIGINT">
                <constraints nullable="false" unique="true" />
            </column>
        </addColumn>
        <rollback>
            <dropColumn tableName="AREA_TYPES_CLASS" columnName="GLOBAL_ID" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-306-3" author="shnaider_ab" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="AREA_TYPES_KIND" columnName="GLOBAL_ID" />
            </not>
        </preConditions>
        <comment>Создание колонки GLOBAL_ID</comment>
        <addColumn tableName="AREA_TYPES_KIND">
            <column name="GLOBAL_ID" type="BIGINT">
                <constraints nullable="false" unique="true" />
            </column>
        </addColumn>
        <rollback>
            <dropColumn tableName="AREA_TYPES_KIND" columnName="GLOBAL_ID" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-306-4" author="shnaider_ab" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="POLICY_TYPE" columnName="GLOBAL_ID" />
            </not>
        </preConditions>
        <comment>Создание колонки GLOBAL_ID</comment>
        <addColumn tableName="POLICY_TYPE">
            <column name="GLOBAL_ID" type="BIGINT">
                <constraints nullable="false" unique="true" />
            </column>
        </addColumn>
        <rollback>
            <dropColumn tableName="POLICY_TYPE" columnName="GLOBAL_ID" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-306-5" author="shnaider_ab" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE_MEDICAL_POSITIONS" columnName="ID" />
            <not>
                <columnExists tableName="AREA_TYPE_MEDICAL_POSITIONS" columnName="GLOBAL_ID" />
            </not>
        </preConditions>
        <renameColumn
                tableName="AREA_TYPE_MEDICAL_POSITIONS"
                newColumnName="GLOBAL_ID"
                oldColumnName="ID"
        />
        <rollback>
            <dropColumn tableName="AREA_TYPE_MEDICAL_POSITIONS" columnName="ID" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-306-6" author="shnaider_ab" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE_RELATIONS" columnName="ID" />
            <not>
                <columnExists tableName="AREA_TYPE_RELATIONS" columnName="GLOBAL_ID" />
            </not>
        </preConditions>
        <renameColumn
                tableName="AREA_TYPE_RELATIONS"
                newColumnName="GLOBAL_ID"
                oldColumnName="ID"
        />
        <rollback>
            <dropColumn tableName="AREA_TYPE_RELATIONS" columnName="ID" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-306-7" author="shnaider_ab" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE_SPECIALIZATIONS" columnName="ID" />
            <not>
                <columnExists tableName="AREA_TYPE_SPECIALIZATIONS" columnName="GLOBAL_ID" />
            </not>
        </preConditions>
        <renameColumn
                tableName="AREA_TYPE_SPECIALIZATIONS"
                newColumnName="GLOBAL_ID"
                oldColumnName="ID"
        />
        <rollback>
            <dropColumn tableName="AREA_TYPE_SPECIALIZATIONS" columnName="ID" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-306-8" author="shnaider_ab" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="GENDER" columnName="GLOBAL_ID" />
            </not>
        </preConditions>
        <comment>Создание колонки GLOBAL_ID</comment>
        <addColumn tableName="GENDER">
            <column name="GLOBAL_ID" type="BIGINT">
                <constraints nullable="false" unique="true" />
            </column>
        </addColumn>
        <rollback>
            <dropColumn tableName="GENDER" columnName="GLOBAL_ID" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-306-9" author="shnaider_ab" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="SPECIALIZATION" columnName="ID" />
            <not>
                <columnExists tableName="SPECIALIZATION" columnName="GLOBAL_ID" />
            </not>
        </preConditions>
        <renameColumn
                tableName="SPECIALIZATION"
                newColumnName="GLOBAL_ID"
                oldColumnName="ID"
        />
        <rollback>
            <dropColumn tableName="SPECIALIZATION" columnName="ID" />
        </rollback>
    </changeSet>

    <changeSet id="CONTINGENT2-NSI-290-1" author="mkachalov" labels="1.0.0.0">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="AREA_TYPE" columnName="GENDER_CODE" />
        </preConditions>
        <comment>Изменение длины поля GENDER_CODE таблицы AREA_TYPE</comment>
        <modifyDataType columnName="GENDER_CODE" newDataType="VARCHAR2(50)" tableName="AREA_TYPE"/>
    </changeSet>

</databaseChangeLog>
